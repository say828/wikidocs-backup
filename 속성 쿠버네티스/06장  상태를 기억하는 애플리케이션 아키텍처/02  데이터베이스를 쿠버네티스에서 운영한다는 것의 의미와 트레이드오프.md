## 02. 데이터베이스를 쿠버네티스에서 운영한다는 것의 의미와 트레이드오프

자, 이제 우리는 기술적으로 '가능하다'는 것을 알았다. 스테이트풀셋과 동적 프로비저닝이라는 강력한 도구를 손에 쥔 우리는, 이론적으로 거의 모든 종류의 상태 저장 애플리케이션을 쿠버네티스 클러스터 위에 올릴 수 있다. 이 기술적 성취는 우리를 하나의 매혹적인 질문 앞으로 이끈다. "그렇다면, 우리의 가장 소중한 데이터가 담긴 프로덕션 데이터베이스도 쿠버네티스 위로 옮겨야 하는가?"

이 질문은 기술 커뮤니티를 오랫동안 양분해 온 뜨거운 감자다. 이 결정은 단순히 기술 스택을 하나 더 추가하는 문제가 아니다. 그것은 당신의 조직이 데이터에 대한 **책임의 무게**를 어디까지 짊어질 것인가에 대한 근본적인 철학적 선택이다. AWS RDS나 Google Cloud SQL과 같은 완전 관리형 서비스(Managed Service)가 제공하는 안락함을 포기하고, 데이터베이스의 생명주기 전체를 스스로 책임지는 험난한 길을 선택하는 데에는 그만한 이유와 대가가 따른다.

### 통합 플랫폼의 매혹적인 약속 (The "Pros")

왜 우리는 굳이 이 어려운 길을 가려고 하는가? 그 이유는 쿠버네티스가 약속하는 **'궁극의 통합'**이라는 달콤한 과실 때문이다.

1.  **운영의 단일화:** 당신의 모든 인프라—stateless 마이크로서비스, stateful 데이터베이스, 메시지 큐, 캐시—가 동일한 쿠버네티스 API를 통해 관리된다. 더 이상 데이터베이스를 위해서는 AWS 콘솔을, 애플리케이션 배포를 위해서는 `kubectl`을, 모니터링을 위해서는 또 다른 시스템을 넘나들 필요가 없다. 모든 것이 하나의 선언적인 GitOps 워크플로우 안에서 일관되게 관리된다. 이는 플랫폼 팀의 인지 부하를 극적으로 줄여준다.
2.  **개발자 셀프서비스:** 개발팀이 새로운 기능을 위해 임시 테스트 데이터베이스가 필요할 때, 더 이상 티켓을 열고 인프라팀의 응답을 며칠씩 기다릴 필요가 없다. 그들은 자신들의 마이크로서비스를 배포하던 것과 똑같은 방식으로, 간단한 YAML 파일을 Git에 커밋하는 것만으로 몇 분 안에 완전히 격리된 데이터베이스 인스턴스를 프로비저닝할 수 있다. 이는 개발 속도를 비약적으로 향상시킨다.
3.  **이식성과 비용 효율성:** 관리형 서비스는 특정 클라우드 제공업체에 당신을 옭아매는 가장 강력한 족쇄다. 쿠버네티스 위에서 데이터베이스를 운영한다는 것은, 당신의 전체 애플리케이션 스택을 온프레미스든, AWS든, GCP든, 그 어떤 쿠버네티스 클러스터 위로든 자유롭게 옮길 수 있는 진정한 이식성을 확보한다는 의미다. 또한, 쿠버네티스의 지능적인 빈 패킹(bin packing) 스케줄링을 통해 관리형 서비스보다 더 높은 컴퓨팅 자원 효율성을 달성할 잠재력도 있다.

### 하지만, 당신은 이제 데이터베이스 관리자(DBA)다 (The "Cons")

이 모든 장밋빛 미래에는 혹독한 현실이 따른다. 당신이 데이터베이스를 쿠버네티스 위에서 직접 운영하기로 결정하는 순간, 당신은 더 이상 플랫폼 엔지니어일 뿐만 아니라, **그 데이터베이스의 생사를 책임지는 데이터베이스 관리자(DBA)**가 된다. 관리형 서비스가 투명하게 처리해주던 다음과 같은 모든 'Day-2 운영'의 짐이 고스란히 당신의 어깨 위로 떨어진다.

* **백업 및 복구:** 정기적인 백업은 어떻게 수행할 것인가? 특정 시점(Point-in-Time) 복구는 가능한가? 재해가 발생했을 때, 이 백업 데이터를 이용해 다른 지역의 클러스터에서 데이터베이스를 복원하는 절차는 검증되었는가?
* **패치 및 업그레이드:** 데이터베이스의 마이너 버전 패치나 메이저 버전 업그레이드를 어떻게 무중단으로 수행할 것인가? 이 과정에서 데이터 스키마 마이그레이션은 어떻게 처리할 것인가?
* **고가용성(High Availability) 및 튜닝:** Primary 노드가 다운되었을 때 Standby 노드로의 장애 조치(Failover)는 자동으로 이루어지는가? 디스크 I/O 병목이나 느린 쿼리 문제를 어떻게 진단하고 해결할 것인가?

이 모든 것은 쿠버네티스만으로는 해결할 수 없는, 데이터베이스 고유의 깊은 전문 지식을 요구하는 영역이다. 이 복잡성을 해결하기 위한 현대적인 해답이 바로 12장에서 자세히 다룰 **오퍼레이터 패턴(Operator Pattern)**이다. 잘 만들어진 데이터베이스 오퍼레이터는 이 모든 복잡한 Day-2 운영 작업을 자동화된 코드로 캡슐화하여, 마치 관리형 서비스처럼 보이게 만드는 마법을 부린다. 하지만 오퍼레이터 역시 만병통치약이 아니며, 그 자체로 또 다른 관리의 대상이 된다.

**결론적으로,** 데이터베이스를 쿠버네티스에서 운영할 것인가에 대한 정답은 없다. 오직 당신의 조직이 처한 상황에 따른 **현명한 트레이드오프**만이 존재할 뿐이다.

* **개발/테스트 환경에서는,** 거의 항상 훌륭한 선택이다.
* **프로덕션 환경에서는,** 당신의 조직이 이 모든 운영 부담을 감당할 수 있는 성숙도와 전문성을 갖추었는지, 그리고 관리형 서비스를 사용하는 비용보다 직접 운영하는 것의 이점이 정말로 큰지를 냉철하게 자문해야 한다.

이 모든 위험을 감수하고 데이터베이스를 클러스터 안에서 운영하기로 결정했다면, 우리는 최후의 안전망에 대해 이야기해야만 한다. 만약 클러스터 전체가 파괴되는 최악의 재난이 닥쳤을 때, 우리의 소중한 데이터를 어떻게 다른 곳에서 되살릴 수 있을까? 다음 절에서는 이 재해 복구 시나리오를 위한 최종 병기, Velero에 대해 알아볼 것이다.