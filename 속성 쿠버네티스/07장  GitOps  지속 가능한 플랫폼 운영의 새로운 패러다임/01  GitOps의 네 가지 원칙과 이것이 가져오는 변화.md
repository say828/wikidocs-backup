## 01. GitOps의 네 가지 원칙과 이것이 가져오는 변화

GitOps라는 용어를 처음 세상에 알린 Weaveworks는 이 패러다임을 지탱하는 네 가지 명확한 원칙을 제시했다. 이 원칙들은 단순히 기술적인 규칙을 넘어, 플랫폼을 운영하는 문화 자체를 바꾸는 강력한 힘을 가지고 있다.

**첫째, 시스템의 모든 것은 선언적으로 기술되어야 한다 (Declarative).**
이것은 GitOps의 출발점이다. 우리의 전체 시스템—애플리케이션, 인프라, 설정, 정책 등 모든 것—은 YAML 파일과 같이 상태를 선언하는 파일들로 표현되어야 한다. 이 파일들은 실행 절차가 아닌, 시스템이 최종적으로 도달해야 할 '목표 상태'를 정의한다.

**둘째, 그 선언적 상태는 Git에서 버전 관리되어야 한다 (Versioned in Git).**
Git 저장소는 우리 시스템의 유일한 **진실의 원천(Single Source of Truth)**이 된다. 클러스터의 '이상적인 상태'는 더 이상 누군가의 로컬 머신이나 머릿속에 존재하는 것이 아니라, 오직 Git의 커밋 기록 속에만 존재한다. 이는 우리에게 다음과 같은 강력한 이점을 제공한다.
* **감사 추적:** 모든 변경 사항은 `git log`를 통해 누가, 언제, 왜 변경했는지 완벽하게 추적할 수 있다.
* **손쉬운 롤백:** 프로덕션에 문제가 발생하면, 우리는 클러스터에 허둥지둥 접속하는 대신, 그저 `git revert` 명령으로 이전의 안정적인 커밋으로 되돌리기만 하면 된다. 그러면 GitOps 에이전트가 알아서 클러스터의 상태를 해당 커밋의 상태로 복원해준다.

**셋째, 승인된 변경 사항은 클러스터에 자동으로 적용되어야 한다 (Automated).**
Git 저장소의 특정 브랜치(예: `main` 브랜치)에 변경 사항이 병합(merge)되면, 그 즉시 클러스터에 자동으로 반영되어야 한다. 더 이상 인간의 수동 `kubectl apply` 개입은 없다. 변경 사항의 승인(Pull Request 리뷰)과 실제 배포가 분리됨으로써, 개발자는 인프라에 직접 접근할 권한 없이도 안전하게 변경을 제안하고 적용할 수 있다.

**넷째, 소프트웨어 에이전트가 상태를 지속적으로 동기화한다 (Continuously Reconciled).**
이것이 GitOps의 화룡점정이다. 클러스터 내부에는 **에이전트(Agent)** 소프트웨어(예: Argo CD, Flux)가 설치되어, Git 저장소에 선언된 '이상적인 상태'와 클러스터의 '실제 상태'를 끊임없이 비교한다. 만약 두 상태 간에 차이, 즉 **드리프트(Drift)**가 감지되면(예: 누군가 운영 목적으로 `kubectl scale` 명령을 실행했다면), 에이전트는 즉시 이를 인지하고 Git 저장소의 상태에 맞춰 클러스터를 자동으로 복원한다. 이 **지속적인 조정(Continuous Reconciliation)** 루프야말로 클러스터의 엔트로피를 막고, 우리가 선언한 상태를 굳건히 지키는 자가 치유 능력의 핵심이다.



이 네 가지 원칙이 가져오는 변화는 혁명적이다.
* **개발자 경험(DevEx) 향상:** 개발자는 쿠버네티스의 복잡한 내부를 몰라도 된다. 그저 익숙한 Git 워크플로우(코드 작성 -> Pull Request -> 리뷰 -> 병합)를 따르기만 하면 자신의 변경 사항이 마법처럼 프로덕션에 반영되는 것을 경험한다.
* **신뢰성과 안정성 강화:** 모든 변경은 리뷰를 거치고, 드리프트는 자동으로 수정되며, 롤백은 즉각적이다. 이는 플랫폼의 안정성을 극적으로 향상시킨다.
* **보안 강화:** `kubeconfig`를 개발자에게 나눠줄 필요가 없어진다. 클러스터에 대한 쓰기 권한은 오직 GitOps 에이전트만이 가지게 되므로, 공격 표면이 최소화된다.

이제 이 아름다운 철학을 현실로 구현해 줄 가장 강력한 도구, Argo CD의 세계로 들어가 보자.