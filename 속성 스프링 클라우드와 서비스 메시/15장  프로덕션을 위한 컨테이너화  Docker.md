# 15장: 프로덕션을 위한 컨테이너화: Docker

## 00. 왜 Docker인가?: "제 PC에선 됐는데요"의 종말

14장까지 우리는 여러 마이크로서비스를 성공적으로 개발하고 테스트했습니다. 이제 다음 질문에 답할 차례입니다.

> **"이 서비스들을 어떻게 서버에 배포하고, 안정적으로 실행할 것인가?"**

과거에는 서버 관리자가 직접 서버에 접속하여, 특정 버전의 자바(Java)를 설치하고, 환경 변수를 설정하고, 애플리케이션 `.jar` 파일을 복사하여 실행하는 방식으로 배포했습니다. 이 방식은 고질적인 문제점을 가지고 있었습니다.

* **개발자:** "제 PC에서는 완벽하게 동작하는데요."
* **서버 관리자:** "서버에서는 `NoClassDefFoundError`가 발생합니다. 자바 버전이 다른 것 같네요."

이처럼 개발 환경과 운영(프로덕션) 환경의 미묘한 차이(OS, 설치된 라이브러리 버전, 환경 변수 등)로 인해 발생하는 수많은 배포 실패는 모든 개발팀의 악몽이었습니다.

**Docker**는 바로 이 **"제 PC에선 됐는데요(It works on my machine)"**라는 말을 역사 속으로 사라지게 만든 혁신적인 기술입니다.

---

### 컨테이너: 표준화된 운송 상자 🚢

Docker의 핵심 아이디어는 **컨테이너(Container)**입니다. 이는 해운업계의 '운송 컨테이너'에서 영감을 받았습니다.

* **과거:** 피아노, 자동차, 바나나를 운송하려면 각각 다른 방식의 포장과 운송 수단이 필요했습니다. 매우 비효율적이었습니다.
* **현재:** 피아노든 자동차든 모두 **'표준화된 강철 상자(컨테이너)'**에 담습니다. 이제 항구, 크레인, 트럭, 선박은 내용물이 무엇인지 신경 쓸 필요 없이, 오직 '컨테이너'를 옮기는 방법에만 집중하면 됩니다.



Docker는 이 개념을 소프트웨어에 적용했습니다.

* **운송할 화물:** 우리의 애플리케이션(`.jar`), 그리고 실행에 필요한 모든 것(특정 버전의 JVM, OS 라이브러리, 설정 파일 등)
* **Docker 컨테이너:** 이 모든 것을 하나로 담는 **'표준화된 소프트웨어 상자'**

이 '상자' 덕분에, 개발자의 노트북에서 실행되던 환경이 그대로 격리되어 패키징되므로, 이 상자를 AWS, GCP, Azure, 혹은 사내 서버 등 **Docker가 설치된 곳이라면 어디든지** 가져다 놓아도 100% 동일하게 동작하는 것을 보장합니다.

---

### Docker의 핵심 개념

* **이미지 (Image):** 컨테이너를 생성하기 위한 **'설계도' 또는 '템플릿'**입니다. 읽기 전용(Read-only)이며, 애플리케이션을 실행하는 데 필요한 모든 것(OS 레이어, 런타임, 코드)을 포함합니다. (비유: 붕어빵 틀)
* **컨테이너 (Container):** 이미지의 **'실행 가능한 인스턴스'**입니다. 격리된 공간에서 실제로 실행되는 프로세스입니다. (비유: 붕어빵 틀로 찍어낸 붕어빵)
* **Dockerfile:** 이미지를 만들기 위한 **'레시피'**입니다. 어떤 OS를 기반으로, 어떤 파일을 복사하고, 어떤 명령어를 실행할지 순서대로 정의하는 간단한 텍스트 파일입니다.

### Docker를 사용해야 하는 이유

1.  **환경의 일관성 및 재현성:** "제 PC에선 됐는데요" 문제의 완벽한 해결책입니다. 개발, 테스트, 운영 환경이 100% 동일해집니다.
2.  **완벽한 격리:** 각 컨테이너는 자신만의 파일 시스템, 네트워크, 프로세스 공간을 가집니다. `member-service` 컨테이너의 장애가 `order-service` 컨테이너에 영향을 주지 않습니다.
3.  **이식성 (Portability):** "한 번 빌드하면, 어디서든 실행된다(Build once, run anywhere)." 클라우드 벤더 종속성에서 벗어날 수 있습니다.
4.  **빠른 배포와 확장:** 가상 머신(VM)이 부팅되는 데 수 분이 걸리는 반면, 컨테이너는 수 초 안에 시작됩니다. 이는 MSA의 빠른 배포와 탄력적인 스케일링(Scaling) 요구사항에 완벽하게 부합합니다.

결론적으로, Docker는 MSA를 안정적으로 운영하기 위한 **필수 기반 기술**입니다. 이 장에서는 우리의 코틀린 스프링 부트 애플리케이션을 위한 최적화된 `Dockerfile`을 작성하고, `Docker Compose`를 사용하여 로컬 환경에서 전체 MSA 스택을 한 번에 실행하는 방법을 배울 것입니다.