# 02장: 아키텍처의 청사진: DDD와 이커머스 도메인 설계

## 00. 왜 MSA는 DDD(도메인 주도 설계)에서 시작해야 하는가?

많은 팀이 마이크로서비스 아키텍처(MSA)를 도입할 때 저지르는 가장 큰 실수는, 기술(Technology)적인 관점에서 서비스를 분리하려는 것입니다.

* "회원 기능은 `MemberService`로 빼자."
* "상품 기능은 `ProductService`로 빼자."
* "주문 기능은 `OrderService`로 빼자."

언뜻 보면 합리적으로 보이지만, 이는 **'분산된 모놀리스(Distributed Monolith)'**라는 최악의 아키텍처로 가는 지름길입니다.

왜일까요? '주문'이라는 비즈니스 로직을 생각해 봅시다. '주문'을 하려면 '회원'의 등급을 확인해서 쿠폰을 적용하고, '상품'의 재고를 확인해야 합니다. 만약 `OrderService`가 `MemberService`와 `ProductService`의 데이터베이스 테이블 구조나 내부 로직을 직접 참조하며 강하게 결합(Tightly Coupled)되어 있다면 어떻게 될까요?

'회원 등급' 정책이 변경되어 `MemberService`의 코드가 수정되면, 이와 결합된 `OrderService`도 장애가 발생하거나 함께 수정 후 배포해야 합니다. 이는 MSA의 핵심 목표인 **'독립적인 개발과 배포(Independent Deployability)'**에 정면으로 위배됩니다.

---

### DDD: '올바른' 경계를 찾는 나침반

MSA의 성공은 '얼마나 잘게 쪼갰는가'가 아니라 **'어떻게 올바른 경계로 쪼갰는가'**에 달려있습니다.

이 '올바른 경계'는 기술이 아닌 **비즈니스 도메인(Business Domain)** 그 자체에서 찾아야 합니다. 그리고 이 경계를 찾는 가장 강력하고 검증된 방법론이 바로 **DDD(도메인 주도 설계, Domain-Driven Design)**입니다.

DDD는 소프트웨어의 복잡성이 기술이 아닌 '도메인(즉, 비즈니스 본질)' 자체에 있다고 봅니다. 따라서 개발자는 '이커머스'라는 도메인을 전문가(기획자, 현업 담당자)와 함께 이해하고, 이 도메인의 복잡성을 관리하는 데 집중해야 합니다.

DDD는 이 복잡한 도메인을 관리 가능한 작은 단위로 분리하는 전략적 도구들을 제공합니다. 그중 MSA와 가장 직접적으로 연결되는 개념이 바로 **'바운디드 컨텍스트(Bounded Context)'**입니다.

* **바운디드 컨텍스트 (Bounded Context, 경계가 있는 문맥):**
    하나의 '용어'가 '하나의 의미'로만 사용되는 명확한 경계를 의미합니다.
    예를 들어, 이커머스 시스템에서 '상품(Product)'이라는 용어는 여러 의미로 쓰입니다.
    * **상품(Product) 컨텍스트:** '상품'은 이름, 이미지, 설명, 카테고리 등 '전시'를 위한 정보를 의미합니다.
    * **재고(Inventory) 컨텍스트:** '상품'은 'SKU-1234'라는 재고 관리 번호와 '재고 수량'을 의미합니다.
    * **주문(Order) 컨텍스트:** '상품'은 주문서에 찍힌 '주문 항목(Order Line)'이며, 주문 시점의 '가격'을 의미합니다.

DDD는 이렇게 모호한 '상품'을 '전시 컨텍스트', '재고 컨텍스트', '주문 컨텍스트'라는 명확한 '바운디드 컨텍스트'로 분리하라고 조언합니다.

그리고 이 **'바운디드 컨텍스트'가 바로 우리가 찾아 헤매던 '마이크로서비스'의 가장 이상적인 경계**가 됩니다.

---

MSA를 DDD 없이 시작하는 것은, 청사진 없이 복잡한 건물을 짓는 것과 같습니다. 반면 DDD는 우리에게 아키텍처의 '청사진'을 제공합니다.

이번 장에서는 DDD의 전략적 설계 도구(유비쿼터스 랭귀지, 바운디드 컨텍스트, 컨텍스트 맵)를 활용하여, 우리가 만들 이커머스 프로젝트의 서비스 경계를 명확히 확정하고, 각 서비스의 책임과 관계를 정의하는 '아키텍처 청사진'을 완성할 것입니다.