## Kiali 대시보드: 서비스 메시 토폴로지 시각화 및 실시간 트래픽 분석

지금까지 우리는 `VirtualService`, `DestinationRule` 같은 YAML 파일을 통해 Istio의 강력한 트래픽 제어 기능을 설정했습니다. 하지만 이 복잡한 규칙들이 실제로 우리 시스템에 어떻게 적용되고 있는지, 서비스 간의 트래픽은 지금 이 순간 어떻게 흐르고 있는지 **'눈'으로 직접 확인**할 방법은 없을까요?

`Grafana`가 메트릭을 시각화하고 `Jaeger`가 트레이스를 시각화한다면, **Kiali**는 \*\*서비스 메시 자체의 구성과 토폴로지(Topology)\*\*를 시각화하는 전문 도구입니다.

-----

### Kiali: 서비스 메시를 위한 "실시간 작전 지도" 🗺️

**Kiali**는 Istio 서비스 메시를 위한 오픈소스 관찰 가능성(Observability) 플랫폼입니다. Kiali는 다음 세 가지 소스로부터 정보를 수집하여, 서비스 메시의 모든 것을 보여주는 통합된 '작전 지도'를 제공합니다.

1.  **쿠버네티스 API 서버:** 어떤 `Service`, `Deployment`, `Pod`가 있는지 (구조 정보)
2.  **Istio 컨트롤 플레인 (Istiod):** 어떤 `VirtualService`, `DestinationRule`이 적용되어 있는지 (정책 정보)
3.  **Prometheus:** 서비스 간에 실제로 얼마나 많은 트래픽이, 얼마나 빠른 속도로, 얼마나 많은 에러와 함께 흐르고 있는지 (실시간 데이터)

-----

### Kiali의 핵심 기능

#### 1\. Graph (그래프 뷰): 살아 숨 쉬는 아키텍처 다이어그램

Kiali의 가장 강력한 기능입니다. 우리 MSA의 서비스 간 **의존성 관계와 트래픽 흐름을 실시간으로 자동 생성**하여 보여줍니다.

  * **실시간 트래픽 시각화:** 화살표의 움직임을 통해 어느 서비스가 어느 서비스를 호출하는지 직관적으로 보여줍니다.
  * **상태 시각화:** Prometheus 메트릭을 기반으로, 정상적인 트래픽은 **녹색** 선으로, 에러율이 높은 트래픽은 **빨간색** 선으로 표시하여 문제 지점을 즉시 식별할 수 있습니다.
  * **정보 오버레이:** 그래프 위에 초당 요청 수(RPS), 응답 시간, 서킷 브레이커 상태 등을 오버레이하여 보여줄 수 있습니다. 22장 02절에서 구현한 카나리 배포 상황이라면, `product-service`로 가는 트래픽이 `v1`과 `v2`로 나뉘어 흐르는 것을 이 그래프에서 직접 눈으로 확인할 수 있습니다.

#### 2\. Applications / Workloads / Services 뷰

클러스터에 배포된 각 컴포넌트에 대한 상세 정보를 제공합니다. 특정 서비스(예: `product-service`)를 선택하면 다음과 같은 정보를 심층 분석할 수 있습니다.

  * **Inbound/Outbound Metrics:** 해당 서비스로 들어오고 나가는 트래픽의 상세 메트릭.
  * **Traces:** 해당 서비스와 관련된 트레이스를 Jaeger와 연동하여 직접 조회.
  * **Istio Config:** **(디버깅에 매우 유용)** 현재 이 서비스에 적용되고 있는 모든 `VirtualService`, `DestinationRule`, `Gateway` 등의 Istio 설정 YAML을 한 곳에서 모두 확인할 수 있습니다.

#### 3\. Istio Config 뷰

클러스터에 적용된 모든 Istio 리소스들을 확인하고, 유효성을 검증할 수 있습니다. Kiali는 "존재하지 않는 `subset`으로 라우팅하는 `VirtualService`"와 같이 흔히 발생하는 설정 오류를 자동으로 감지하고 경고해 줍니다.

-----

### Kiali 대시보드 실행하기

Istio를 `demo` 프로파일로 설치했다면 Kiali는 이미 설치되어 있을 가능성이 높습니다. `istioctl`을 사용하면 매우 간단하게 Kiali 대시보드를 로컬 PC에서 열어볼 수 있습니다.

```bash
# Kiali 애드온이 설치되어 있는지 확인
istioctl dashboard

# Kiali 대시보드를 실행하고 웹 브라우저로 열기
istioctl dashboard kiali
```

이 명령어는 로컬 PC와 쿠버네티스 클러스터의 Kiali Pod 사이에 안전한 터널(Port-forwarding)을 생성하고, 자동으로 웹 브라우저를 열어 대시보드를 보여줍니다.

-----

이것으로 22장을 마칩니다. 우리는 Istio의 핵심 트래픽 제어 리소스인 `VirtualService`와 `DestinationRule`을 마스터했습니다. 이를 통해 **카나리 배포**와 같은 정교한 트래픽 시프팅을 구현했고, `Resilience4j`의 기능을 플랫폼 레벨로 **외부화**하여 재시도와 서킷 브레이커를 적용했으며, **장애 주입**을 통해 시스템의 탄력성을 검증했습니다. 마지막으로 **Kiali** 대시보드를 통해 이 모든 복잡한 상호작용을 한눈에 파악하는 '눈'까지 갖게 되었습니다.

이제 우리의 MSA는 안정적이고 유연한 트래픽 제어 능력을 갖추었습니다. 다음 23장에서는 서비스 메시의 또 다른 강력한 축인 **보안**, 특히 \*\*상호 TLS(mTLS)\*\*를 이용한 제로 트러스트 네트워크 구축에 대해 알아보겠습니다.