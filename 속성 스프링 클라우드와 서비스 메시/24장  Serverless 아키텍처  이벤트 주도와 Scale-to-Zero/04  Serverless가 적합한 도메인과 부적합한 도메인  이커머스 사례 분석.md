## Serverless가 적합한 도메인과 부적합한 도메인: 이커머스 사례 분석

24장의 여정을 통해 우리는 서버리스(Serverless)가 '서버 관리'의 부담을 없애고 '사용한 만큼만 지불'하는 강력한 패러다임임을 확인했습니다. 하지만 서버리스는 만병통치약이 아니며, 그 특유의 장단점으로 인해 특정 도메인에는 매우 적합하지만, 다른 도메인에는 오히려 독이 될 수 있습니다.

최고의 아키텍트는 기술의 '장점'뿐만 아니라 '한계'를 명확히 이해하고, 비즈니스 문제에 맞는 최적의 도구를 선택하는 사람입니다. 우리 이커머스 시스템의 각 도메인을 분석하여 서버리스 적합도를 평가해 봅시다.

---

### ✅ 서버리스가 적합한(Good Fit) 도메인

서버리스는 다음과 같은 특징을 가진 워크로드에서 빛을 발합니다.
* **비동기적 / 이벤트 기반 (Asynchronous / Event-Driven):** 사용자의 즉각적인 응답을 기다릴 필요 없는 백그라운드 작업.
* **불규칙하거나 예측 불가능한 트래픽 (Spiky Traffic):** 트래픽이 특정 시간에만 몰리거나, 거의 호출되지 않아 유휴 시간이 긴 작업.
* **상태 없음 (Stateless):** 실행 간 상태를 유지할 필요 없는 짧은 생명주기의 작업.

#### 1. 알림 서비스 (Notification Service) - 이메일, SMS, 푸시 발송

* **적합도: ⭐️⭐️⭐️ (매우 뛰어남)**
* **이유:** 이것은 서버리스의 교과서적인 사용 사례입니다. `OrderPaid`나 `ShipmentStarted` 같은 이벤트에 의해 비동기적으로 트리거됩니다. 주문이 없을 때는 전혀 호출되지 않다가(비용 0), 블랙 프라이데이 세일 시간에는 수천 개의 알림을 동시에 처리해야 합니다(자동 스케일링). 24시간 내내 서버를 띄워두는 것은 엄청난 낭비입니다.

#### 2. 이미지 처리 서비스 (Image Processing Service) - 리사이징, 워터마크

* **적합도: ⭐️⭐️⭐️ (매우 뛰어남)**
* **이유:** 판매자가 고화질의 상품 원본 이미지를 S3 버킷에 업로드하는 '이벤트'가 발생했을 때만 트리거됩니다. 함수는 이 원본 이미지로 여러 사이즈의 썸네일을 생성하여 다시 S3에 저장한 뒤 종료됩니다. 전형적인 비동기/이벤트 기반 작업입니다.

#### 3. 주기적인 배치(Batch) 작업

* **적합도: ⭐️⭐️ (좋음)**
* **이유:** "매일 자정에 어제의 매출 통계 집계", "매주 월요일 아침에 휴면 계정 정리" 등 주기적으로 실행되는 작업에 매우 비용 효율적입니다. AWS EventBridge Scheduler 같은 스케줄러를 트리거로 사용합니다. 단, 함수의 최대 실행 시간(예: 15분) 안에 끝날 수 있는 작업이어야 합니다.

---

### ❌ 서버리스가 부적합한(Poor Fit) 도메인

#### 1. API 게이트웨이 (API Gateway)

* **적합도: ⭐️ (매우 나쁨)**
* **이유:** 게이트웨이는 시스템의 '최초 진입점'으로, 항상 켜져 있어야 하며 **가장 낮은 지연 시간(Latency)**이 요구됩니다. 사용자의 첫 요청이 **콜드 스타트(Cold Start)**로 인해 몇 초씩 걸리는 것은 절대 용납될 수 없습니다.

#### 2. 핵심 동기 API 서비스 (Core Synchronous APIs) - 주문, 상품 API

* **적합도: ⭐️ (나쁨)**
* **이유:** "주문 생성", "상품 상세 정보 조회" 등 사용자와 직접 상호작용하는 핵심 API는 예측 가능하고 낮은 지연 시간이 생명입니다. 서버리스의 콜드 스타트라는 '불확실성'은 이러한 서비스의 품질(SLA)을 보장하기 어렵게 만듭니다. 항상 '웜업(Warm-up)' 상태를 유지하는 쿠버네티스의 상시 실행 Pod가 훨씬 더 안정적인 선택입니다.

#### 3. 상태 유지가 필요한 서비스 (Stateful Services) - 실시간 채팅

* **적합도: ⭐️ (매우 나쁨)**
* **이유:** 웹소켓(WebSocket)을 이용한 실시간 고객 상담 채팅 서비스 등을 가정해 봅시다. 이 서비스는 사용자와의 긴 생명주기를 가진 '연결(Connection)' 상태를 서버 메모리에 유지해야 합니다. 짧게 실행되고 사라지는 서버리스 함수로는 이러한 상태 기반 연결을 유지할 수 없습니다.

| 워크로드 | 서버리스 적합도 | 핵심 이유 |
| :--- | :--- | :--- |
| **알림/이미지 처리** | ✅ **최적** | 이벤트 기반, 비동기, 예측 불가능한 트래픽 |
| **주기적 배치 작업**| ✅ **좋음** | 비정기적 실행, 비용 효율성 (단, 실행 시간 제한 내) |
| **API 게이트웨이**| ❌ **부적합**| 상시 실행 및 최소 지연 시간 요구, 콜드 스타트 치명적 |
| **핵심 동기 API** | ❌ **부적합**| 예측 가능한 낮은 지연 시간 요구, 콜드 스타트 위험 |
| **웹소켓/채팅** | ❌ **부적합**| 상태 기반(Stateful)의 긴 연결 유지 필요 |

**결론적으로,** '서버리스 vs 컨테이너(쿠버네티스)'는 어느 한쪽이 우월한 제로섬 게임이 아닙니다. 성숙한 아키텍처는 두 가지를 모두 사용하는 **하이브리드(Hybrid) 모델**로 귀결됩니다. 사용자와의 실시간 상호작용이 중요한 **핵심 API 서비스는 쿠버네티스** 위에서 안정적으로 운영하고, **비동기 백그라운드 작업은 서버리스**를 활용하여 비용 효율성과 확장성을 극대화하는 것이 최고의 실무자가 선택할 수 있는 가장 현명한 전략입니다.