### init 블록을 활용한 초기화 로직

주 생성자는 파라미터를 받아 프로퍼티를 초기화하는 역할을 매우 간결하게 수행하지만, 그 자체로는 어떠한 로직도 담을 수 없습니다. 객체가 생성되는 시점에 프로퍼티 초기화 외에 추가적인 작업—예를 들어, 전달받은 값의 유효성을 검사하거나, 초기화된 값을 바탕으로 다른 프로퍼티를 계산하거나, 생성 로그를 남기는 등의 작업—이 필요하다면 어떻게 해야 할까요?

이럴 때 사용하는 것이 바로 **초기화 블록(Initializer Block)**, 즉 **`init`** 블록입니다.

`init` 블록은 클래스의 객체가 생성될 때, 주 생성자와 함께 실행되는 코드 블록입니다. 주 생성자를 통해 프로퍼티가 초기화된 직후에 `init` 블록 내부의 코드가 실행됩니다.

#### `init` 블록의 역할과 사용법

`init` 블록은 클래스 본문 내에 `init` 키워드와 중괄호 `{...}`로 정의합니다.

```kotlin
import java.time.LocalDate // 현재 날짜를 가져오기 위해 임포트

class Person(val name: String, val birthYear: Int) {
    
    // 이 프로퍼티는 생성자에서 직접 값을 받지 않고, init 블록에서 계산하여 초기화됩니다.
    val age: Int

    // 초기화 블록
    init {
        println("init 블록: ${name} 객체 생성을 시작합니다.")

        // 1. 유효성 검사 로직
        if (birthYear > LocalDate.now().year) {
            throw IllegalArgumentException("출생 연도가 현재 연도보다 미래일 수 없습니다.")
        }

        // 2. 프로퍼티 계산 및 초기화
        age = LocalDate.now().year - birthYear

        println("init 블록: ${name} 객체 생성이 완료되었습니다. 나이: $age")
    }
}
```

위 예제에서 `init` 블록은 세 가지 중요한 역할을 수행합니다.

1.  **로깅:** 객체가 생성되고 있음을 알리는 로그를 출력합니다.
2.  **유효성 검사:** 생성자로 전달받은 `birthYear` 값이 논리적으로 올바른지 검사합니다.
3.  **복합 프로퍼티 초기화:** 생성자 파라미터를 바탕으로 추가적인 계산을 통해 `age` 프로퍼티를 초기화합니다.

`init` 블록은 클래스 내에 여러 개를 선언할 수도 있으며, 이 경우 위에서 아래 순서대로 실행됩니다.

```kotlin
fun main() {
    val person = Person("김코틀", 2011)
    println("${person.name}의 나이는 ${person.age}세입니다.")

    // val invalidPerson = Person("미래인", 2077) // IllegalArgumentException 발생!
}
```

**실행 순서:**

1.  `Person` 객체 생성을 시도하며 주 생성자에 "김코틀", 2011을 전달합니다.
2.  주 생성자가 `name`, `birthYear` 프로퍼티를 초기화합니다.
3.  `init` 블록이 순서대로 실행됩니다.
4.  모든 초기화 과정이 끝나고 `person` 변수에 완전히 생성된 객체가 할당됩니다.

#### 부 생성자와의 관계

부 생성자는 반드시 주 생성자에게 생성을 위임(`this(...)`)해야 한다고 배웠습니다. 이 규칙 때문에, **어떤 생성자(주 생성자, 부 생성자)를 통해 객체를 생성하든 `init` 블록은 항상 실행됩니다.** 모든 생성의 흐름이 결국 주 생성자를 거치기 때문입니다. 이는 클래스의 핵심적인 초기화 로직이 항상 일관되게 수행됨을 보장하는 매우 중요한 특징입니다.

`init` 블록은 주 생성자의 부족한 부분을 보완하여, 객체가 생성되는 시점에 반드시 실행되어야 하는 검증 및 준비 로직을 담는 이상적인 장소입니다. 이를 통해 우리는 항상 완벽하게 초기화된, 신뢰할 수 있는 객체를 만들 수 있습니다.