# 01장: BSON과 도큐먼트 데이터 모델의 정수

이전 00장에서 우리는 MongoDB의 아키텍처를 조망하고 개발 환경을 구축했습니다. 이제 데이터베이스의 가장 본질적인 요소인 '데이터' 그 자체에 집중할 시간입니다. 훌륭한 데이터 모델은 애플리케이션의 성능, 확장성, 그리고 유지보수 용이성을 결정하는 가장 중요한 초석입니다. 이번 장에서는 MongoDB 데이터 모델링의 근간을 이루는 BSON의 타입 시스템을 이해하고, 다양한 비즈니스 요구사항을 가장 효율적인 도큐먼트 구조로 설계하는 핵심 패턴들을 마스터하게 될 것입니다.

-----

## 00\. JSON을 넘어선 BSON: 타입 시스템과 효율성

MongoDB의 도큐먼트 모델이 개발자에게 친숙한 이유는 그 구조가 웹 API와 현대 프로그래밍 언어에서 사실상의 표준으로 사용되는 **JSON(JavaScript Object Notation)** 과 매우 유사하기 때문입니다. JSON은 사람이 읽고 쓰기 쉬운 텍스트 기반의 포맷으로, 데이터를 교환하는 데에는 더할 나위 없이 훌륭합니다.

하지만 고성능 데이터베이스가 데이터를 '저장'하고 '처리'하는 데에는 순수한 JSON만으로는 부족합니다. 데이터베이스는 텍스트를 파싱하는 시간조차 아껴야 하고, 보다 풍부하고 명확한 데이터 타입을 필요로 하기 때문입니다. MongoDB는 이러한 요구사항을 충족시키기 위해 **BSON(Binary JSON)** 이라는 형식을 사용합니다.

BSON은 JSON을 이진(Binary) 형태로 직렬화한 포맷으로, 다음과 같은 결정적인 장점을 가집니다.

### 1\. 확장된 타입 시스템 (Rich Type System)

JSON의 타입은 문자열, 숫자, 불리언, 배열, 객체, null 정도로 매우 단순합니다. 예를 들어, JSON의 '숫자' 타입은 32비트 정수인지, 64비트 정수인지, 아니면 부동소수점 숫자인지 구분하지 않습니다. BSON은 데이터베이스에 필수적인 다음과 같은 다양한 타입을 추가로 지원합니다.

  * `ObjectId`: 도큐먼트의 기본 키(`_id`)를 위해 사용되는 12바이트 고유 식별자입니다. 타임스탬프, 머신 ID, 프로세스 ID, 카운터 값을 조합하여 분산 시스템 환경에서도 거의 충돌 없이 고유한 값을 생성합니다.
  * `Date`: 날짜와 시간을 UTC 기준으로 나타내는 64비트 정수입니다. 문자열로 날짜를 저장하는 것보다 비교, 정렬, 범위 쿼리 등에서 훨씬 효율적이고 정확합니다.
  * `Int32 / Int64 (Long)`: 32비트 정수와 64비트 정수를 명확하게 구분하여 저장합니다.
  * `Decimal128`: 금융 데이터나 정밀한 계산이 필요한 과학 데이터에서 부동소수점 연산의 오류를 피하기 위한 128비트 십진수 표현입니다. 이커머스의 주문 금액, 결제 정보를 다룰 때 필수적입니다.
  * `Binary Data`: 이미지, 오디오 파일 또는 다른 이진 데이터를 도큐먼트 내에 직접 저장할 수 있게 해줍니다.

### 2\. 빠른 탐색 속도 (Traversal Speed)

BSON의 가장 중요한 설계 목표 중 하나는 바로 '빠른 탐색'입니다. BSON 도큐먼트는 각 필드와 값 앞에 해당 요소의 타입과 길이(바이트) 정보를 포함하고 있습니다.

```json
// JSON 표현
{ "user": "atlas_dev", "score": 100 }
```

위 JSON을 BSON으로 변환하면, 내부적으로는 `(문서 전체 길이)(string 타입 코드)"user"(null 종료)(string 값)(int32 타입 코드)"score"(null 종료)(int32 값)` 과 같은 구조를 갖게 됩니다.

이 '길이' 정보 덕분에, 데이터베이스 엔진은 특정 필드를 찾기 위해 도큐먼트 전체를 처음부터 끝까지 파싱할 필요가 없습니다. 예를 들어 `score` 필드의 값을 읽고 싶다면, `user` 필드의 길이를 읽고 그만큼 건너뛰어(skip) `score` 필드에 바로 접근할 수 있습니다. 텍스트 기반인 JSON은 이런 '건너뛰기'가 불가능하여 항상 전체를 파싱해야 하는 것과 비교하면 엄청난 성능상의 이점입니다.

### 3\. 효율성

BSON은 이진 포맷이므로 일반적으로 텍스트 기반인 JSON보다 더 적은 공간을 차지하며, 네트워크를 통해 전송되거나 디스크에 저장될 때 더 효율적입니다. 또한, 데이터를 파싱하는 과정에서 CPU 자원을 덜 소모합니다.

결론적으로, BSON은 JSON의 유연하고 친숙한 모델을 그대로 유지하면서, 데이터베이스 시스템에 필수적인 **엄격한 타입 시스템**과 **성능**이라는 두 마리 토끼를 모두 잡은 핵심 기술입니다. MongoDB를 제대로 이해하고 사용한다는 것은 곧 이 BSON의 특성을 이해하고 데이터 모델링에 적극적으로 활용하는 것을 의미합니다.