# Part 2: 견고한 토대 구축: 핵심 서비스와 IaC(Infrastructure as Code)

---

# 02장: 모든 것은 코드로 말한다: IaC를 통한 아키텍처의 재현성과 진화

우리는 1장에서 위대한 아키텍처를 위한 나침반, AWS Well-Architected Framework를 손에 쥐었다. 운영 우수성, 보안, 안정성, 성능, 비용, 그리고 지속 가능성이라는 6개의 원칙은 우리가 나아갈 방향을 명확히 제시한다. 그러나 아무리 훌륭한 나침반과 지도가 있어도, 그것을 현실 세계에 구현할 견고한 토대와 신뢰할 수 있는 도구가 없다면 우리의 여정은 한 걸음도 나아갈 수 없다.

Part 2에서는 바로 이 토대를 구축하는 방법에 대해 이야기한다. 클라우드 네이티브 아키텍처라는 정교한 건축물을 세우기 전에, 우리는 먼저 땅을 다지고 주춧돌을 놓아야 한다. 이 주춧돌의 이름이 바로 **IaC(Infrastructure as Code)**다. IaC는 클라우드 인프라(서버, 데이터베이스, 네트워크 등)를 AWS 콘솔에서 마우스로 클릭하여 만드는 것이 아니라, 프로그래밍 코드를 통해 정의하고 관리하는 접근 방식이다.

이것은 단순히 작업 방식의 변화가 아니다. 이것은 인프라를 일회성의 수공예품이 아닌, 버전 관리되고, 테스트되며, 자동으로 배포되는 **소프트웨어**로 취급하는 근본적인 패러다임의 전환이다. 이 장에서는 왜 수동 작업이 현대 클라우드 환경에서 '죄악'에 가까운지 그 위험성을 파헤치고, IaC를 대표하는 두 거인, Terraform과 AWS CDK를 비교 분석하며 우리 여정의 표준 도구를 선택할 것이다. 그리고 이 책의 모든 아키텍처를 뒷받침할 실전적인 IaC 프로젝트의 구조를 함께 설계해 볼 것이다. 모든 것은 이제, 코드로 말하게 될 것이다.

---

## 00. 왜 수동 작업은 죄악인가: 클릭옵스(ClickOps)의 함정

AWS를 처음 접하는 많은 이들은 AWS Management Console의 편리함에 감탄한다. 몇 번의 클릭만으로 가상 서버(EC2)가 생성되고, 데이터베이스(RDS)가 실행되며, 로드 밸런서(ALB)가 트래픽을 분산하기 시작한다. 프로토타입을 만들거나 간단한 테스트를 진행할 때, 이 그래픽 사용자 인터페이스(GUI)는 분명 매력적이고 직관적인 도구다.

하지만 이 편리함의 이면에는 치명적인 독이 숨어있다. 프로덕션 환경을 구축하고 운영하는 데 있어 이 수동 클릭 작업에 의존하는 순간, 당신은 **클릭옵스(ClickOps)**라는 깊은 함정에 빠지게 된다. '클릭옵스'란 인프라 관리를 오직 웹 콘솔에서의 수동 클릭에 의존하는 안티패턴을 경멸적으로 일컫는 용어다. 나는 이것을 단순한 안티패턴을 넘어, 클라우드 시대의 **'죄악(Sin)'**이라고 단언한다. 이는 Well-Architected의 거의 모든 원칙을 정면으로 위배하는 행위이기 때문이다.

**클릭옵스가 죄악인 이유**

1.  **인간의 실수를 필연적으로 유발한다 (안정성 위배):** 인간은 완벽하지 않다. 수십, 수백 개의 설정값을 가진 인프라를 수동으로 구성하다 보면 실수는 반드시 발생한다. 개발 환경에서는 열었던 보안 그룹 포트를 스테이징 환경에서는 잊어버리고, 프로덕션 데이터베이스의 백업 설정 옵션을 실수로 비활성화할 수 있다. 이러한 사소한 실수 하나가 전체 서비스의 중단이나 치명적인 데이터 유실로 이어질 수 있다.

2.  **재현성이 전혀 보장되지 않는다 (운영 우수성 위배):** 당신이 3개월 전에 클릭으로 구축한 프로덕션 환경과 똑같은 환경을 오늘 다시 만들 수 있는가? 아마 불가능할 것이다. 어떤 설정을 왜 그렇게 했는지 기억에 의존하거나, 부정확하고 오래된 위키(Wiki) 문서에 기대야 한다. 재해 복구 상황이 발생하거나, 새로운 리전으로 서비스를 확장해야 할 때, 재현성이 없는 인프라는 비즈니스의 발목을 잡는 가장 큰 족쇄가 된다.

3.  **변경 사항을 추적하고 검토할 수 없다 (운영 우수성 위배):** 누가, 언제, 왜 VPC의 라우팅 테이블을 수정했는가? 이 변경이 어떤 영향을 미칠지 동료가 검토(Code Review)했는가? 클릭옵스 환경에서는 이러한 변경 이력을 체계적으로 추적하고 관리할 방법이 없다. 모든 변경은 '암묵적'으로 이루어지며, 문제가 발생했을 때 원인을 파악하고 이전 상태로 되돌리는(Rollback) 것은 거의 불가능에 가깝다.

4.  **규모의 확장을 불가능하게 만든다 (성능 효율성 및 비용 최적화 위배):** 마이크로서비스 아키텍처가 도입되면 관리해야 할 환경의 수는 기하급수적으로 늘어난다. 수십 개의 서비스, 그리고 각 서비스마다 존재하는 개발, 스테이징, 프로덕션 환경을 클릭으로 관리하는 것은 상상할 수 없는 비효율을 초래한다. 인프라팀은 끊임없는 수동 작업의 늪에 빠져 혁신적인 아키텍처 개선에 투자할 시간을 완전히 잃어버리게 된다.

[그림: 클릭옵스의 악순환 다이어그램]

클릭옵스는 처음에는 쉬워 보이지만, 시스템이 복잡해질수록 기술 부채를 눈덩이처럼 불어나게 하여 결국 조직 전체의 민첩성을 갉아먹는다. 이는 마치 튼튼한 설계도 없이 손의 감각만으로 거대한 성을 쌓으려는 것과 같다. 처음에는 빠르게 올라가는 것처럼 보이지만, 결국 자신의 무게를 이기지 못하고 무너져 내릴 운명이다.

따라서 우리는 선언해야 한다. **"프로덕션 환경의 그 어떤 리소스도 수동 클릭으로 생성하거나 변경하지 않는다."** 이 원칙을 지키는 것이 바로 클라우드 네이티브 아키텍처를 향한 첫걸음이며, 이 죄악으로부터 우리를 구원할 유일한 방법이 바로 **인프라스트럭처 애즈 코드(Infrastructure as Code)**다.