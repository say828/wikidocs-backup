## 03. Lambda: 이벤트 기반 아키텍처의 심장, 그 명과 암

제어와 책임의 스펙트럼, 그 가장 끝자락에 **AWS Lambda**가 서 있다. EC2가 우리에게 서버라는 '땅'을 주었고, ECS/EKS가 컨테이너라는 '조립식 주택'을 주었다면, Lambda는 우리에게 오직 **'기능(Function)'**이라는 전기 스위치만 남겨두고 나머지 모든 것을 어둠 속으로 감춰버린다. 우리는 더 이상 서버의 존재, 운영체제, 컨테이너 런타임에 대해 생각할 필요가 없다. 우리가 할 일은 오직 스위치에 연결될 전선, 즉 비즈니스 로직을 담은 코드 조각을 작성하는 것뿐이다. 그리고 특정 **이벤트(Event)**가 발생할 때, AWS는 마법처럼 그 코드에 전기를 흘려보내 실행시킨다.

이것이 바로 **서버리스(Serverless)**, 혹은 더 정확하게는 **FaaS(Function as a Service)**의 본질이다. Lambda는 클라우드 네이티브의 궁극적인 지향점 중 하나인 '인프라로부터의 완전한 해방'을 약속한다. 이 약속이 가져다주는 빛은 너무나 눈부시지만, 그 빛이 강렬할수록 그림자 또한 짙게 드리워진다. Lambda의 진정한 가치를 이해하기 위해, 우리는 그 명과 암을 모두 냉정하게 직시해야 한다.

### Lambda의 빛 (明): 서버리스가 약속하는 유토피아

1.  **운영 부담 제로 (Zero Administration):** Lambda를 선택하는 가장 큰 이유는 '차별성 없는 무거운 작업'의 완전한 소멸이다. OS 패치, 보안 업데이트, 서버 용량 산정, 오토 스케일링 그룹 설정, 컨테이너 클러스터 관리... 이 모든 것이 당신의 책임 목록에서 영원히 사라진다. 개발팀은 오직 비즈니스 가치를 전달하는 코드에만 100% 집중할 수 있다. 이는 조직의 민첩성을 극대화하는 가장 확실한 방법이다.
2.  **궁극의 비용 효율성:** "사용하지 않으면, 비용도 없다." 이것이 Lambda의 비용 모델을 관통하는 철학이다. 코드가 실행되는 정확한 시간(밀리초 단위)과 호출 횟수에 대해서만 비용을 지불한다. 하루에 단 10번 호출되는 기능이라면 정확히 10번만큼의 비용만 내면 된다. 24시간 내내 대기하며 비용을 발생시키는 EC2 인스턴스나, 최소한의 유휴 상태를 유지해야 하는 컨테이너와는 근본적으로 다르다. 이는 트래픽이 없거나 예측이 극도로 어려운 워크로드에서 압도적인 비용 절감 효과를 가져온다. 
3.  **무한에 가까운 자동 확장성:** 블랙프라이데이 세일이 시작되어 초당 수천 개의 요청이 몰려든다고 상상해 보자. EC2나 컨테이너 환경에서는 이 트래픽을 감당하기 위해 사전에 복잡한 오토 스케일링 정책을 설정하고 충분한 예비 용량을 확보해야 한다. Lambda는 이 모든 것을 자동으로 처리한다. 요청이 들어오는 만큼, AWS는 거의 실시간으로 함수의 실행 환경을 수천, 수만 개로 복제하여 대응한다. 당신은 스케일링에 대해 아무것도 걱정할 필요가 없다.

### Lambda의 그림자 (暗): 대가 없는 자유는 없다

이처럼 매력적인 장점에도 불구하고, Lambda는 만병통치약이 아니다. 서버를 추상화한 대가로 우리는 새로운 종류의 제약과 복잡성을 마주하게 된다.

1.  **콜드 스타트 (Cold Start):** 한동안 호출되지 않았던 함수가 처음 호출될 때, AWS는 실행 환경(마이크로 VM)을 새로 프로비저닝하고, 코드를 다운로드하며, 런타임을 초기화하는 과정을 거친다. 이로 인해 첫 응답이 수백 밀리초에서 심지어 수 초까지 지연될 수 있다. 사용자 요청에 즉각적으로 반응해야 하는 민감한 API의 경우, 이 콜드 스타트는 치명적인 성능 저하로 느껴질 수 있다.
2.  **실행 시간 및 자원 제약:** Lambda 함수는 최대 **15분**까지만 실행될 수 있다. 따라서 대용량 데이터를 처리하는 배치 작업이나, 오랜 시간이 걸리는 머신러NING 모델 훈련과 같은 롱 러닝(Long-running) 태스크에는 적합하지 않다. 또한, 할당 가능한 메모리, 임시 저장 공간(/tmp), 동시 실행 횟수 등에도 명확한 제약이 존재한다.
3.  **상태 비저장(Stateless)의 어려움:** Lambda 함수는 본질적으로 상태를 저장하지 않는다. 각 호출은 독립적이고 격리된 환경에서 실행된 후 사라진다. 따라서 여러 호출에 걸쳐 데이터를 공유하거나 상태를 유지해야 하는 경우, DynamoDB나 ElastiCache와 같은 외부 스토리지에 의존해야만 한다. 이는 아키텍처의 복잡성을 증가시키는 요인이 된다.
4.  **벤더 종속성 (Vendor Lock-in):** Lambda는 AWS 생태계에 깊이 종속된 서비스다. EventBridge, SQS, API Gateway 등 다른 AWS 서비스와 결합될 때 최고의 시너지를 내도록 설계되었다. 이는 한번 Lambda 기반으로 아키텍처를 구축하면, 다른 클라우드 제공업체로 이전하기가 매우 어려워짐을 의미한다.

### 이벤트 기반 아키텍처의 심장

이러한 명과 암에도 불구하고, Lambda가 현대 클라우드 네이티브 아키텍처에서 대체 불가능한 역할을 하는 영역이 있다. 바로 **이벤트 기반 아키텍처(Event-Driven Architecture, EDA)**의 심장으로서의 역할이다.

전통적인 요청-응답(Request-Response) 모델에서는 서비스 A가 서비스 B의 API를 직접 호출한다. 이는 두 서비스 사이에 강한 결합(Tight Coupling)을 만들어, 서비스 B에 장애가 발생하면 서비스 A까지 연쇄적으로 영향을 받게 된다.

EDA에서는 서비스들이 직접 통신하는 대신, '주문이 생성됨', '결제가 완료됨'과 같은 **이벤트**를 중앙 이벤트 버스(예: Amazon EventBridge)로 발행(Publish)한다. Lambda 함수들은 이 이벤트를 구독(Subscribe)하고 있다가, 관심 있는 이벤트가 발생했을 때만 트리거되어 자신의 임무를 수행한다.



이 구조에서 Lambda는 각 서비스를 연결하는 완벽한 '접착제(Glue Code)' 역할을 한다. S3에 이미지가 업로드되면(이벤트), Lambda 함수가 트리거되어 이미지 썸네일을 생성한다. DynamoDB에 새로운 사용자 데이터가 삽입되면(이벤트), Lambda 함수가 트리거되어 환영 이메일을 발송한다. 각 Lambda 함수는 작고, 독립적이며, 오직 하나의 기능에만 집중한다. 이는 마이크로서비스의 철학을 가장 순수하게 구현하는 방식이며, 시스템 전체의 회복탄력성과 확장성을 극대화한다.

결론적으로, 모든 컴퓨팅 선택은 트레이드오프의 연속이다. **EC2**는 레거시와 특수 요구사항을 위한 최후의 보루이며, **ECS**는 AWS 네이티브의 단순함으로 무장했다. **EKS**는 오픈소스 표준의 유연성과 확장성을 제공하며, **Lambda**는 이벤트 기반 아키텍처의 민첩성을 극대화한다. 위대한 아키텍트는 이 모든 도구의 특성을 꿰뚫어 보고, 지금 해결해야 할 비즈니스 문제에 가장 날카로운 칼을 선택하는 전략가다.

이제 우리는 견고한 대지(IaC) 위에 어떤 심장(컴퓨팅)을 얹을지 결정할 수 있는 지혜를 얻었다. 다음 장에서는 이 심장에 피를 공급하고 생명을 불어넣을 혈액, 즉 **데이터**를 어떻게 설계하고 관리할 것인지, 목적에 맞는 데이터베이스 선택의 세계로 여정을 떠날 것이다.